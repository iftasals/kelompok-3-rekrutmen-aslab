<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>kelompok-3-rekrutmen-aslab</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

  <style>
body {
  padding-top: 70px;
  background-color: #f1f8f4;
  font-family: 'Poppins', sans-serif;
  font-size: 14px;
  color: #333;
}

.section {
  background: #ffffff;
  border-radius: 15px;
  padding: 25px;
  margin-bottom: 30px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.05);
  border-left: 6px solid #81c784;
  transition: 0.3s;
}

.section:hover {
  box-shadow: 0 6px 20px rgba(0,0,0,0.08);
}

.section-header h2 {
  font-size: 20px;
  color: #2e7d32;
  font-weight: 600;
}

.table {
  border-radius: 10px;
  overflow: hidden;
}

.table thead {
  background-color: #e8f5e9;
  color: #2e7d32;
}

.table-bordered td, 
.table-bordered th {
  border-color: #c8e6c9;
}

.table-hover tbody tr:hover {
  background-color: #f0fdf4;
}

.btn-custom {
  background: linear-gradient(to right, #66bb6a, #43a047);
  color: white;
  border: none;
  transition: all 0.3s ease;
}

.btn-custom:hover {
  background: linear-gradient(to right, #57a05b, #2e7d32);
  transform: scale(1.03);
}

.btn-outline-success {
  border-color: #66bb6a;
  color: #388e3c;
}

.btn-outline-success:hover {
  background-color: #66bb6a;
  color: white;
}

.navbar-brand {
  font-weight: 700;
  font-size: 20px;
}

.navbar-light .navbar-nav .nav-link {
  color: #388e3c;
  font-weight: 500;
}

.nav-link.active {
  background-color: #c8e6c9 !important;
  color: #1b5e20 !important;
  border-radius: 5px;
}

footer {
  background-color: #a5d6a7;
  color: #1b5e20;
  font-size: 13px;
  padding: 10px 0;
}
  </style>
</head>
<body>

<!-- Navbar -->
<nav class="navbar fixed-top navbar-expand-lg navbar-light bg-light shadow-sm">
  <div class="container-fluid">
    <a class="navbar-brand text-success fw-bold" href="#">KELOMPOK 3</a>
    <ul class="navbar-nav ms-auto">
      <li class="nav-item">
        <a class="nav-link active" href="#" onclick="showSection('inputSection', this)">Input Nilai</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#" onclick="showSection('hasilSection', this)">Hasil Ranking</a>
      </li>
    </ul>
  </div>
</nav>

<!-- Main Container -->
<div class="container">

  <!-- Halaman Input Nilai -->
  <div id="inputSection">
    <h1 class="text-center text-success mb-4">Profil Matching Seleksi Asisten Laboratorium</h1>
    <div class="mb-4 text-center">
      <button class="btn btn-custom me-2" onclick="prosesSemua()">Hitung Semua</button>
      <button class="btn btn-outline-success me-2" onclick="muatDataAwal()">Muat Data Awal</button>
      <button class="btn btn-danger" onclick="resetSemua()">Reset</button>
    </div>

    <!-- Tabel-tabel Aspek -->
    <div class="section">
      <div class="section-header">
        <h2>Aspek Administrasi</h2>
        <button class="btn btn-sm btn-custom" onclick="tambahBaris('adminTable', 5)">Tambah</button>
      </div>
      <table class="table table-bordered table-striped" id="adminTable">
        <thead class="table-light"><tr><th>Nama</th><th>IPK</th><th>Algo</th><th>Jarkom</th><th>Sertifikat</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>

    <div class="section">
      <div class="section-header">
        <h2>Aspek Kompetensi</h2>
        <button class="btn btn-sm btn-custom" onclick="tambahBaris('kompTable', 3)">Tambah</button>
      </div>
      <table class="table table-bordered table-striped" id="kompTable">
        <thead class="table-light"><tr><th>Nama</th><th>Pemrograman</th><th>Jaringan</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>

    <div class="section">
      <div class="section-header">
        <h2>Aspek Microteaching</h2>
        <button class="btn btn-sm btn-custom" onclick="tambahBaris('microTable', 6)">Tambah</button>
      </div>
      <table class="table table-bordered table-striped" id="microTable">
        <thead class="table-light">
          <tr><th>Nama</th><th>Suara</th><th>Sikap</th><th>Interaksi</th><th>Penguasaan</th><th>Penyampaian</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <div class="section">
      <div class="section-header">
        <h2>Aspek Wawancara</h2>
        <button class="btn btn-sm btn-custom" onclick="tambahBaris('wawanTable', 4)">Tambah</button>
      </div>
      <table class="table table-bordered table-striped" id="wawanTable">
        <thead class="table-light"><tr><th>Nama</th><th>Komitmen</th><th>Konsistensi</th><th>Karakter</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- Halaman Hasil -->
  <div id="hasilSection" style="display:none;">
    <div class="section">
      <h2 class="text-success">Hasil Perhitungan & Ranking</h2>
      <div id="hasil"></div>
    </div>
  </div>

</div>

<script>
const pesertaList = [];
const nilaiHuruf = { "A": 4.0, "B+": 3.5, "B": 3.0, "C+": 2.5, "C": 2.0, "D": 1.5, "E": 1.0 };
const bobotGap = g => ({ 0:5, 1:4.5, "-1":4, 2:3.5, "-2":3, 3:2.5, "-3":2, 4:1.5, "-4":1 }[g] || 1);
const bobotIPK = ipk => ipk >= 3.76 ? 5 : ipk >= 3.51 ? 4 : ipk >= 3.01 ? 3 : ipk >= 2.76 ? 2 : 1;
const bobotNilaiKuliah = v => v >= 3.76 ? 5 : v >= 3.51 ? 4 : v >= 3.01 ? 3 : v >= 2.76 ? 2 : 1;
const bobotKompetensi = v => v >= 81 ? 5 : v >= 71 ? 4 : v >= 61 ? 3 : v >= 51 ? 2 : 1;

function hitungProfileMatching(p) {
  // === Konversi nilai huruf ke angka (Tabel 6) ===
  const nilaiHuruf = { "A": 4.0, "B+": 3.5, "B": 3.0, "C+": 2.5, "C": 2.0, "D": 1.5, "E": 1.0 };

  // === Konversi IPK dan rata-rata ke bobot (Tabel 5) ===
  const bobotIPK = ipk => ipk >= 3.76 ? 5 : ipk >= 3.51 ? 4 : ipk >= 3.01 ? 3 : ipk >= 2.76 ? 2 : 1;

  // === Konversi nilai kompetensi (Tabel 9) ===
  const bobotKompetensi = nilai => nilai >= 81 ? 5 : nilai >= 71 ? 4 : nilai >= 61 ? 3 : nilai >= 51 ? 2 : 1;

  // === Konversi GAP ke bobot nilai (Tabel 1) ===
  const bobotGap = gap => {
    const table = { 0: 5, 1: 4.5, "-1": 4, 2: 3.5, "-2": 3, 3: 2.5, "-3": 2, 4: 1.5, "-4": 1 };
    return table[gap] ?? 1;
  };

  // === Nilai Preferensi (standar) ===
  const preferensi = {
    ipk: 5,
    nilaikuliah: 4,
    sertifikat: 3,
    kompetensi: 4,
    suara: 4,
    penguasaan: 3,
    penyampaian: 3,
    sikap: 4,
    interaksi: 5,
    komitmen: 5,
    konsistensi: 5,
    karakter: 3
  };

  // === Konversi data ===
  const ipk_b = bobotIPK(p.ipk);
  const algo = nilaiHuruf[p.algo] ?? 0;
  const jar = nilaiHuruf[p.jar] ?? 0;
  const rataKuliah = (algo + jar) / 2;
  const nilaikuliah = bobotIPK(rataKuliah);
  const sertifikat = p.sertifikat === "Ada" ? 3 : 1;

  const kompetensi = bobotKompetensi((p.prog + p.jarkom) / 2);

  // === Microteaching ===
  const suara = parseInt(p.suara);
  const penguasaan = parseInt(p.penguasaan);
  const penyampaian = parseInt(p.penyampaian);
  const sikap = parseInt(p.sikap);
  const interaksi = parseInt(p.interaksi);

  // === Wawancara ===
  const komitmen = parseInt(p.komitmen);
  const konsistensi = parseInt(p.konsistensi);
  const karakter = parseInt(p.karakter);

  // === GAP & Bobot GAP ===
  const gap = (nilai, preferensi) => bobotGap(nilai - preferensi);

  // === Hitung CF & SF per aspek ===

  // Aspek 1: Administrasi (CF: ipk, nilaikuliah; SF: sertifikat)
  const cf1 = (gap(ipk_b, preferensi.ipk) + gap(nilaikuliah, preferensi.nilaikuliah)) / 2;
  const sf1 = gap(sertifikat, preferensi.sertifikat);
  const N1 = ((cf1 + sf1) / 2).toFixed(2);

  // Aspek 2: Kompetensi (CF: kompetensi)
  const N2 = gap(kompetensi, preferensi.kompetensi).toFixed(2);

  // Aspek 3: Microteaching
  const cf3 = (gap(suara, preferensi.suara) + gap(penguasaan, preferensi.penguasaan) + gap(penyampaian, preferensi.penyampaian)) / 3;
  const sf3 = (gap(sikap, preferensi.sikap) + gap(interaksi, preferensi.interaksi)) / 2;
  const N3 = ((cf3 + sf3) / 2).toFixed(2);

  // Aspek 4: Wawancara
  const cf4 = (gap(komitmen, preferensi.komitmen) + gap(konsistensi, preferensi.konsistensi)) / 2;
  const sf4 = gap(karakter, preferensi.karakter);
  const N4 = ((cf4 + sf4) / 2).toFixed(2);

  const total = ((parseFloat(N1) + parseFloat(N2) + parseFloat(N3) + parseFloat(N4)) / 4).toFixed(2);

  return {
    nama: p.nama,
    N1: parseFloat(N1),
    N2: parseFloat(N2),
    N3: parseFloat(N3),
    N4: parseFloat(N4),
    total: parseFloat(total)
  };
}

function ambilDataPerNama(nama) {
  function ambilDariTabel(id, keys) {
    const trs = document.getElementById(id).querySelectorAll("tbody tr");
    for (const tr of trs) {
      const tds = tr.querySelectorAll("td");
      if (tds[0].innerText === nama) {
        const values = Array.from(tds).slice(1).map(td => td.innerText.trim());
        const obj = {};
        keys.forEach((k, i) => obj[k] = isNaN(values[i]) ? values[i] : parseFloat(values[i]));
        return obj;
      }
    }
    return {};
  }
  return {
    nama,
    ...ambilDariTabel("adminTable", ["ipk", "algo", "jar", "sertifikat"]),
    ...ambilDariTabel("kompTable", ["prog", "jarkom"]),
    ...ambilDariTabel("microTable", ["suara", "sikap", "interaksi", "penguasaan", "penyampaian"]),
    ...ambilDariTabel("wawanTable", ["komitmen", "konsistensi", "karakter"])
  };
}

function prosesSemua() {
  pesertaList.length = 0;
  const trs = document.querySelectorAll("#adminTable tbody tr");
  trs.forEach(tr => {
    const nama = tr.querySelector("td").innerText.trim();
    const data = ambilDataPerNama(nama);
    const hasil = hitungProfileMatching(data);
    pesertaList.push(hasil);
  });
  tampilkanHasil();
  showSection('hasilSection');
}

function tampilkanHasil() {
  const sorted = pesertaList.slice().sort((a, b) => b.total - a.total);
  let html = '<table class="table table-bordered table-hover"><tr><th>Nama</th><th>N1</th><th>N2</th><th>N3</th><th>N4</th><th>Total</th><th>Ranking</th></tr>';
  sorted.forEach((p, i) => {
    html += `<tr><td>${p.nama}</td><td>${p.N1.toFixed(2)}</td><td>${p.N2.toFixed(2)}</td><td>${p.N3.toFixed(2)}</td><td>${p.N4.toFixed(2)}</td><td>${p.total.toFixed(2)}</td><td>${i + 1}</td></tr>`;
  });
  html += '</table>';
  document.getElementById("hasil").innerHTML = html;
}

function resetSemua() {
  document.querySelectorAll("tbody").forEach(tbody => tbody.innerHTML = "");
  document.getElementById("hasil").innerHTML = "";
  pesertaList.length = 0;
}

function tambahBaris(tableId, colCount) {
  const tbody = document.querySelector(`#${tableId} tbody`);
  const row = document.createElement('tr');
  for (let i = 0; i < colCount; i++) {
    const td = document.createElement('td');
    td.contentEditable = true;
    td.innerText = '';
    row.appendChild(td);
  }
  tbody.appendChild(row);
}

function muatDataAwal() {
  resetSemua();
  const data = [
    { nama:"R", ipk:3.88, algo:"B", jar:"A", sertifikat:"Ada", prog:85, jarkom:60, suara:5, sikap:5, interaksi:4, penguasaan:3, penyampaian:4, komitmen:4, konsistensi:4, karakter:4 },
    { nama:"J", ipk:3.24, algo:"A", jar:"B", sertifikat:"Ada", prog:65, jarkom:70, suara:4, sikap:4, interaksi:4, penguasaan:3, penyampaian:3, komitmen:3, konsistensi:3, karakter:3 },
    { nama:"O", ipk:3.88, algo:"B", jar:"B", sertifikat:"Tidak", prog:80, jarkom:50, suara:3, sikap:4, interaksi:3, penguasaan:4, penyampaian:3, komitmen:4, konsistensi:4, karakter:5 },
    { nama:"H", ipk:3.68, algo:"B", jar:"B", sertifikat:"Tidak", prog:50, jarkom:20, suara:3, sikap:4, interaksi:5, penguasaan:5, penyampaian:4, komitmen:3, konsistensi:3, karakter:4 }
  ];
  data.forEach(d => {
    document.querySelector("#adminTable tbody").innerHTML += `<tr><td>${d.nama}</td><td>${d.ipk}</td><td>${d.algo}</td><td>${d.jar}</td><td>${d.sertifikat}</td></tr>`;
    document.querySelector("#kompTable tbody").innerHTML += `<tr><td>${d.nama}</td><td>${d.prog}</td><td>${d.jarkom}</td></tr>`;
    document.querySelector("#microTable tbody").innerHTML += `<tr><td>${d.nama}</td><td>${d.suara}</td><td>${d.sikap}</td><td>${d.interaksi}</td><td>${d.penguasaan}</td><td>${d.penyampaian}</td></tr>`;
    document.querySelector("#wawanTable tbody").innerHTML += `<tr><td>${d.nama}</td><td>${d.komitmen}</td><td>${d.konsistensi}</td><td>${d.karakter}</td></tr>`;
  });
}

function showSection(sectionId, navLink = null) {
  document.getElementById("inputSection").style.display = "none";
  document.getElementById("hasilSection").style.display = "none";
  document.getElementById(sectionId).style.display = "block";

  document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('active'));
  if (navLink) navLink.classList.add('active');
}
</script>

</body>

<footer class="text-center py-3 mt-5" style="background-color: #c8e6c9; color: #1b5e20;">
  <small>
    Kelompok:<br>
    Siti Nurfadilah - 23670038 |
    Ifta Dila Salsabila - 23670047 |
    Laily Ratna Agustina - 23670051 |
    Dian Puspitasari - 23670171
  </small>
</footer>


</html>
